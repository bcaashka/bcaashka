<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#" itemscope itemtype="http://schema.org/WebPage"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width,minimum-scale=1"><meta name="description" content="In Java, it&rsquo;s always been easy to run a method or piece of code asynchronous, that is if you have a main method which has a main thread, you can run your task in a separate thread, and you can do this very quickly using a code similar to this."><title>Introduction to Thread Pools in Java. Ideal Thread Pool Size.</title><link rel="shortcut icon" href="https://bcaashka.com/favicon.ico" type="image/x-icon"><link rel="icon" href="https://bcaashka.com/favicon.ico" type="image/x-icon"><link rel="canonical" href="https://bcaashka.com/introduction-to-thread-pools-in-java/"><script async src="/assets/js/lazysizes.js"></script><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700%7CRoboto+Slab:400,700&amp;subset=latin,latin-ext" type="text/css" media="all"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.1/css/fontawesome.min.css"><link rel="stylesheet" href="/assets/css/hesti.css"><meta property="og:title" content="Introduction to Thread Pools in Java"><meta property="og:description" content="In Java, it&rsquo;s always been easy to run a method or piece of code asynchronous, that is if you have a main method which has a main thread, you can run your task in a separate thread, and you can do this very quickly using a code similar to this."><meta property="og:type" content="article"><meta property="og:url" content="https://bcaashka.com/introduction-to-thread-pools-in-java/"><meta property="og:image:alt" content="Introduction to Thread Pools in Java"><meta property="article:published_time" content="2019-08-26T22:27:00+0000"><meta property="article:modified_time" content="2019-08-26T22:27:00+0000"><meta property="og:locale" content="en_US"><meta property="article:section" content="Guides"><meta property="article:tag" content="guides"><meta itemprop="name" content="Introduction to Thread Pools in Java"><meta itemprop="description" content="In Java, it&rsquo;s always been easy to run a method or piece of code asynchronous, that is if you have a main method which has a main thread, you can run your task in a separate thread, and you can do this very quickly using a code similar to this."><meta itemprop="datePublished" content="2019-08-26T22:27:00+0000"><meta itemprop="dateModified" content="2019-08-26T22:27:00+0000"><meta itemprop="wordCount" content="604"><meta itemprop="keywords" content="guides,"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Introduction to Thread Pools in Java"><meta name="twitter:description" content="In Java, it&rsquo;s always been easy to run a method or piece of code asynchronous, that is if you have a main method which has a main thread, you can run your task in a separate thread, and you can do this very quickly using a code similar to this."></head><body class="page post-page"><nav class="navbar navbar-color-on-scroll navbar-transparent fixed-top navbar-expand-lg" color-on-scroll="100"><div class="container"><div class="navbar-translate"><a class="navbar-brand" href="https://bcaashka.com/" title="bcaashka">bcaashka</a> <button class="navbar-toggler" type="button" data-toggle="collapse" aria-expanded="false" aria-label="Toggle navigation"><span class="sr-only">Toggle navigation</span> <span class="navbar-toggler-icon"></span> <span class="navbar-toggler-icon"></span> <span class="navbar-toggler-icon"></span></button></div><div id="navbar-menu" class="collapse navbar-collapse"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" href="https://bcaashka.com/guides/">Guides</a></li></ul></div></div></nav><header class="page-header has-hero-image header-filter purple-filter clear-filter" data-parallax="true" style="background-image: url('');"><div class="container"><div class="row"><div class="col-md-12 mx-auto"><div class="brand"><h1 class="title">Introduction to Thread Pools in Java</h1><nav aria-label="breadcrumb" role="navigation"><ul class="breadcrumb" vocab="http://schema.org/" typeof="BreadcrumbList"><li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href="https://bcaashka.com/"><span property="name">bcaashka</span></a><meta property="position" content="1"></li><li class="breadcrumb-item" property="itemListElement" typeof="ListItem"><a property="item" typeof="WebPage" href="https://bcaashka.com/guides"><span property="name">Guides</span></a><meta property="position" content="2"></li><li class="breadcrumb-item active" property="itemListElement" typeof="ListItem"><a class="disabled" property="item" typeof="WebPage" href="#" aria-current="page"><span property="name">Introduction to Thread Pools in Java</span></a><meta property="position" content="3"></li></ul></nav><div class="published-by">Published by <a class="author" href="https://bcaashka.com/"><strong class="fn" itemprop="author">bcaashka</strong> </a>on <time class="date updated published" datetime="2019-08-26T22:27:00&#43;0000">August 26, 2019</time></div></div></div></div></div></header><div class="main main-raised"><div class="container"><div class="row"><div class="col-md-8 ml-auto mr-auto"><article itemprop="mainEntityOfPage" class="section section-text"><p>In Java, it&rsquo;s always been easy to run a method or piece of code asynchronous, that is if you have a <code>main</code> method which has a main thread, you can run your task in a separate thread, and you can do this very quickly using a code similar to this.</p><pre><code class="language-java">    public static void main(String[] args) {
        Thread thread1 = new Thread(new Task());
        thread1.start();
        System.out.println(&quot;Thread name: &quot; + Thread.currentThread().getName());
    }

    static class Task implements Runnable {
        public void run() {
            System.out.println(&quot;Thread name: &quot; + Thread.currentThread().getName());
        }
    }
</code></pre><h2 id="threads-and-runnables">Threads and Runnables</h2><p>So, you can create a class, for example, <code>Task</code> which implements <code>Runnable</code> then override its run method and put the code that you want to run asynchronously. In this case, we are just doing the <code>System.out.println</code> which will print the name of the thread that it is running in. After that, you can create a new thread and, with the instance of this particular Task, start the thread.</p><p>And here is the way to visualize it: <img class="lazyload alignnone" data-sizes="auto" title="" alt="" data-src="https://bcaashka.com/images/2019/08/java-threads-and-runnable.jpg" data-srcset="https://bcaashka.com/images/2019/08/java-threads-and-runnable.jpg 960w, https://bcaashka.com/images/2019/08/java-threads-and-runnable-768.jpg 768w, https://bcaashka.com/images/2019/08/java-threads-and-runnable-640.jpg 640w"></p><p>There is a main thread which performs its operation from top to down, and at a certain point in time, it will do <code>thread.start()</code> and JVM will create a thread named Thread-0. This thread will do its operations. Once those operations are done JVM will kill that thread and the main thread will keep going.</p><p>If you want to run ten tasks similarly, you can create the threads in a for loop.</p><p>And each iteration it will create a new thread with a new instance of <code>Task</code> and will start that thread. And the way to visualize this is very similar: <img class="lazyload alignnone" data-sizes="auto" title="" alt="" data-src="https://bcaashka.com/images/2019/08/running-multiple-tasks-asynchronously.jpg" data-srcset="https://bcaashka.com/images/2019/08/running-multiple-tasks-asynchronously.jpg 960w, https://bcaashka.com/images/2019/08/running-multiple-tasks-asynchronously-768.jpg 768w, https://bcaashka.com/images/2019/08/running-multiple-tasks-asynchronously-640.jpg 640w"></p><p>JVM will create threads called Thread-0 till thread-9 denoted by t0 to t9 here and once the operations within the run method are complete JVM will kill those threads.</p><h2 id="executors">Executors</h2><p>And what if you want to run 1000 tasks asynchronously? <img class="lazyload alignnone" data-sizes="auto" title="" alt="" data-src="https://bcaashka.com/images/2019/08/running-thousand-tasks-asynchronously.jpg" data-srcset="https://bcaashka.com/images/2019/08/running-thousand-tasks-asynchronously.jpg 960w, https://bcaashka.com/images/2019/08/running-thousand-tasks-asynchronously-768.jpg 768w, https://bcaashka.com/images/2019/08/running-thousand-tasks-asynchronously-640.jpg 640w"></p><p>The problem here is that one Java Thread corresponds to one operating system thread that means if you run the for loop thousand times, it will create one thousand threads. But creating a thread is an expensive operation so what you instead want is you want a fixed number of threads.</p><img class="lazyload alignnone" data-sizes="auto" title="" alt="" data-src="https://bcaashka.com/images/2019/08/java-thread-pool-example.jpg" data-srcset="https://bcaashka.com/images/2019/08/java-thread-pool-example.jpg 960w, https://bcaashka.com/images/2019/08/java-thread-pool-example-768.jpg 768w, https://bcaashka.com/images/2019/08/java-thread-pool-example-640.jpg 640w"><p>Let&rsquo;s have ten threads. Also, you want to create them upfront, let&rsquo;s call it a pool, a pool of threads, and let&rsquo;s submit a thousand tasks to it. After that, we want the threads to pick up those tasks and complete them. And the way to implement this is straightforward:</p><pre><code class="language-java">    public static void main(String[] args) {
        int numberOfThreads = 10;
        ExecutorService executorService = Executors.newFixedThreadPool(numberOfThreads);
        for (int i = 0; i &lt; 1000; i++) {
            executorService.execute(new Task());
        }
        System.out.println(&quot;Thread name: &quot; + Thread.currentThread().getName());
    }

    static class Task implements Runnable {
        public void run() {
            System.out.println(&quot;Thread name: &quot; + Thread.currentThread().getName());
        }
    }
</code></pre><p>You create a new <strong>fixed thread pool</strong> using the static method of <code>Executors</code> class. And in the same for loop that you used earlier but here instead of starting a new thread, you can submit or execute those tasks using the same service. And here is a visualization of that process:</p><img class="lazyload alignnone" data-sizes="auto" title="" alt="" data-src="https://bcaashka.com/images/2019/08/thread-pool-tasks-execution.jpg" data-srcset="https://bcaashka.com/images/2019/08/thread-pool-tasks-execution.jpg 960w, https://bcaashka.com/images/2019/08/thread-pool-tasks-execution-768.jpg 768w, https://bcaashka.com/images/2019/08/thread-pool-tasks-execution-640.jpg 640w"><p>Internally, that thread pool uses a blocking queue. The pool keeps storing all the tasks that you have submitted in that queue. And all the ten threads will perform the same two steps: fetch the next task from the queue and execute it.</p><p>Since all ten threads attempt to take the task from the queue at the same time, you want the queue to be able to handle concurrent operations. So, you want a queue which is thread-safe, and that is why a <strong>thread pool</strong> uses the blocking queue.</p><h2 id="ideal-thread-pool-size">Ideal Thread Pool Size?</h2><p>To be continued&hellip;</p></article></div><div class="col-md-4 mx-auto px-lg-5"><aside class="sidebar"></aside></div></div></div><section class="related-posts"><div class="container"><div class="text-center"><h2 class="title">Related Posts</h2></div><div class="row"><article class="col-md-4"><div class="card card-plain card-blog"><div class="card-header card-header-image"><a href="https://bcaashka.com/spring-framework-architecture/" title="Spring Framework Architecture"><img class="img img-raised lazyload" data-sizes="auto" data-src="/assets/images/default-thumbnail.jpg" title="Spring Framework Architecture" alt="Spring Framework Architecture image"></a></div><div class="card-body"><h6 class="card-category text-success"><a href="https://bcaashka.com/guides" title="View all posts in Guides">Guides</a></h6><h4 class="card-title"><a href="https://bcaashka.com/spring-framework-architecture/" title="Spring Framework Architecture">Spring Framework Architecture</a></h4><p class="card-description">Hey guys. Today I am going to introduce you to Spring Framework and its Core functionality.</p></div></div></article></div></div></section><footer class="footer footer-big footer-black" style=""><div class="container"><div class="row"><div class="col-md-4"></div><div class="col-md-4"></div><div class="col-md-4"></div><div class="col-md-12"><hr><p class="text-left"></p></div></div></div></footer></div><script src="/assets/js/jquery.slim.min.js"></script><script src="/assets/js/popper.min.js"></script><script src="/assets/js/index.js"></script></body></html>